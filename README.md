# Flight Arrival Delay Prediction with Apache Spark ✈️

(Big Data course - Project) 

This project tackles the real-world problem of predicting the arrival delay of commercial flights using machine learning and Apache Spark. It was developed as part of a Big Data course assignment using the Airline On-Time Performance dataset provided by the [Data Expo 2009](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/HG7NV7).

## 📁 Project Structure
```
.
├── app.py                    # Spark application to load and test the model
├── best_model                # Stored trained ML model (generated by notebook)
├── project.ipynb             # Jupyter notebook: data prep, training, validation
├── train.csv                 # CSV data used to train the model (1991 data)
├── test_data.csv             # CSV test data used by Spark app (1989 data)
└── README.md                 # Project description and instructions
└── Documentation_Report.pdf  # Documentation of the project and report of the results
```

## 📊 Problem Statement
The goal is to predict the arrival delay (ArrDelay) of a domestic US flight using features available at take-off. This involves:

- Data analysis and cleaning
- Feature engineering
- Model training and validation
- Model serialization
- Model testing on unseen data using a Spark application

## 🔍 Data Source
Dataset: [Data Expo 2009 - Airline On-Time Performance](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/HG7NV7)
Training year: 1991
Testing year: 1989

<ins>Note:</ins> To conserve computing resources, both the training and testing datasets were limited to 1,000 rows each, as all processing was performed locally on a personal computer.

## ❌ Forbidden Variables
Variables not allowed due to data leakage (known after take-off), e.g.:

ArrTime, ActualElapsedTime, AirTime, TaxiIn, Diverted, CarrierDelay, WeatherDelay, NASDelay, SecurityDelay, LateAircraftDelay

## 🎯 Target Variable
ArrDelay (Arrival Delay in minutes)

## 🧪 ML Pipeline Overview
- Notebook (project.ipynb):
  - Data loading and cleaning
  - Feature transformations (e.g. time parsing, distance categories)
  - Model training and evaluation (e.g. RMSE, R²)
  - Model export (best_model/)
- Spark Application (app.py):
  - Loads model and test dataset
  - Applies same transformations as training
  - Evaluates predictions using regression and business metrics
 
## 📈 Evaluation Metrics
- RMSE: Root Mean Squared Error
- MAE: Mean Absolute Error
- R² Score: Model goodness-of-fit
- 15-min Accuracy: % predictions within 15 minutes of actual delay
- Severe Delay Accuracy: Accuracy on delays > 60 minutes

## 🚀 Running the Application
Make sure Spark is installed and run the app as follows:
```
spark-submit --master local[*] app.py "[path_to_test_data]"
```

## 📦 Requirements
This project uses:
- Python 3.11.9
- Apache Spark (PySpark) 3.5.3
- Jupyter Notebook
